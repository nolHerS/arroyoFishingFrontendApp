<div class="fish-table-container">
  <h2>Capturas de Peces</h2>

  <div class="filters-container">
    <div class="filters">
      <!-- Tipo de pez -->
      <div class="filter-item">
        <i class="pi pi-fish"></i>
        <p-autoComplete [(ngModel)]="fishTypeSearch"
                        [suggestions]="fishTypeSuggestions"
                        (completeMethod)="filterFishType($event)"
                        placeholder="Tipo de pez"
                        [dropdown]="true"
                        [forceSelection]="false"></p-autoComplete>
      </div>

      <!-- UbicaciÃ³n -->
      <div class="filter-item">
        <i class="pi pi-map-marker"></i>
        <p-autoComplete [(ngModel)]="locationSearch"
                        [suggestions]="locationSuggestions"
                        (completeMethod)="filterLocation($event)"
                        placeholder="UbicaciÃ³n"
                        [dropdown]="true"
                        [forceSelection]="false"></p-autoComplete>
      </div>

      <!-- Usuario -->
      <div class="filter-item">
        <i class="pi pi-user"></i>
        <p-autoComplete [(ngModel)]="userSearch"
                        [suggestions]="userSuggestions"
                        (completeMethod)="filterUser($event)"
                        placeholder="Usuario"
                        [dropdown]="true"
                        [forceSelection]="false"></p-autoComplete>
      </div>
    </div>
  </div>

  <p-table [value]="captures | userFilter:users:userSearch"
           [paginator]="true"
           [rows]="10"
           [rowsPerPageOptions]="[5,10,20]"
           scrollable="true"
           styleClass="fish-table">
    <ng-template pTemplate="header">
      <tr>
        <th>ID</th>
        <th>Fecha de captura</th>
        <th>Tipo de pez</th>
        <th>UbicaciÃ³n</th>
        <th>Peso (kg)</th>
        <th>Usuario</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-capture>
      <tr *ngIf="capture.fishType.toLowerCase().includes(fishTypeSearch.toLowerCase()) &&
                 (!locationSearch || (capture.location || '').toLowerCase().includes(locationSearch.toLowerCase()))">
        <td>{{ capture.id }}</td>
        <td>{{ capture.captureData | date:'dd/MM/yyyy' }}</td>
        <td>{{ capture.fishType }}</td>
        <td>{{ capture.location || '-' }}</td>
        <td>{{ capture.weight }}</td>
        <td>{{ getUserName(capture.userId) }}</td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6" class="no-data">No hay capturas registradas ðŸ˜¢</td>
      </tr>
    </ng-template>
  </p-table>
</div>
