<p>image-gallery works!</p>
<!-- Contenedor de la galería -->
<div class="image-gallery" (keydown)="onKeyDown($event)" tabindex="0">

  <!-- Loading state -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando imágenes...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="errorMessage" class="error-container">
    <i class="pi pi-exclamation-triangle"></i>
    <p>{{ errorMessage }}</p>
    <button (click)="loadImages()" class="retry-button">
      Reintentar
    </button>
  </div>

  <!-- Empty state -->
  <div *ngIf="!isLoading && !errorMessage && images.length === 0" class="empty-state">
    <i class="pi pi-image"></i>
    <p>No hay imágenes disponibles</p>
  </div>

  <!-- Grid de imágenes -->
  <div *ngIf="!isLoading && !errorMessage && images.length > 0" class="images-grid">
    <div
      *ngFor="let image of images"
      class="image-card"
      (click)="openImageModal(image)"
    >
      <!-- Thumbnail -->
      <div class="image-wrapper">
        <img
          [src]="image.thumbnailUrl"
          [alt]="image.fileName"
          class="thumbnail"
          loading="lazy"
        />

        <!-- Overlay con información -->
        <div class="image-overlay">
          <div class="image-info">
            <span class="file-name">{{ image.fileName }}</span>
            <span class="file-size">{{ getFileSize(image.fileSize) }}</span>
          </div>

          <!-- Botón eliminar (solo si no es readonly) -->
          <button
            *ngIf="!readonly"
            (click)="deleteImage(image, $event)"
            class="delete-button"
            title="Eliminar imagen"
          >
            <i class="pi pi-trash"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Contador de imágenes -->
  <div *ngIf="images.length > 0" class="image-counter">
    {{ images.length }} / 5 imágenes
  </div>
</div>

<!-- Modal para ver imagen en grande -->
<div
  *ngIf="isModalOpen && selectedImage"
  class="image-modal"
  (click)="closeModal()"
>
  <div class="modal-content" (click)="$event.stopPropagation()">

    <!-- Header del modal -->
    <div class="modal-header">
      <div class="modal-info">
        <h3>{{ selectedImage.fileName }}</h3>
        <p class="modal-meta">
          {{ selectedImage.width }} × {{ selectedImage.height }}px •
          {{ getFileSize(selectedImage.fileSize) }} •
          {{ getUploadDate(selectedImage.uploadedAt) }}
        </p>
      </div>
      <button (click)="closeModal()" class="close-button" title="Cerrar">
        <i class="pi pi-times"></i>
      </button>
    </div>

    <!-- Imagen grande -->
    <div class="modal-image-container">
      <img
        [src]="selectedImage.originalUrl"
        [alt]="selectedImage.fileName"
        class="modal-image"
      />
    </div>

    <!-- Navegación -->
    <button
      *ngIf="images.length > 1"
      (click)="previousImage()"
      class="nav-button nav-prev"
      [disabled]="images[0].id === selectedImage.id"
      title="Anterior"
    >
      <i class="pi pi-chevron-left"></i>
    </button>

    <button
      *ngIf="images.length > 1"
      (click)="nextImage()"
      class="nav-button nav-next"
      [disabled]="images[images.length - 1].id === selectedImage.id"
      title="Siguiente"
    >
      <i class="pi pi-chevron-right"></i>
    </button>

    <!-- Acciones -->
    <div class="modal-actions">
      <a
        [href]="selectedImage.originalUrl"
        target="_blank"
        class="action-button"
        title="Abrir en nueva pestaña"
      >
        <i class="pi pi-external-link"></i>
        Abrir original
      </a>

      <button
        *ngIf="!readonly"
        (click)="deleteImage(selectedImage, $event); closeModal()"
        class="action-button delete"
        title="Eliminar imagen"
      >
        <i class="pi pi-trash"></i>
        Eliminar
      </button>
    </div>
  </div>
</div>